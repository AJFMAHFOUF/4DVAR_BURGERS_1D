import matplotlib.pyplot as plt
import numpy as np
x,ub00_001,ut00_001,ua00_001=np.loadtxt('../data/output_00h_001.dat',unpack=True)
x,ub24_001,ut24_001,ua24_001=np.loadtxt('../data/output_24h_001.dat',unpack=True)
x,ub48_001,ut48_001,ua48_001=np.loadtxt('../data/output_48h_001.dat',unpack=True)
x,ub00_002,ut00_002,ua00_002=np.loadtxt('../data/output_00h_002.dat',unpack=True)
x,ub24_002,ut24_002,ua24_002=np.loadtxt('../data/output_24h_002.dat',unpack=True)
x,ub48_002,ut48_002,ua48_002=np.loadtxt('../data/output_48h_002.dat',unpack=True)
x,ub00_003,ut00_003,ua00_003=np.loadtxt('../data/output_00h_003.dat',unpack=True)
x,ub24_003,ut24_003,ua24_003=np.loadtxt('../data/output_24h_003.dat',unpack=True)
x,ub48_003,ut48_003,ua48_003=np.loadtxt('../data/output_48h_003.dat',unpack=True)
x,ub00_004,ut00_004,ua00_004=np.loadtxt('../data/output_00h_004.dat',unpack=True)
x,ub24_004,ut24_004,ua24_004=np.loadtxt('../data/output_24h_004.dat',unpack=True)
x,ub48_004,ut48_004,ua48_004=np.loadtxt('../data/output_48h_004.dat',unpack=True)
fig=plt.figure()
ax1=fig.add_subplot(231)
ax1.plot(x,ut00_001,label='Truth',linewidth=2,color='red')
ax1.plot(x,ub00_001,label='Back',linewidth=1,color='blue')
ax1.plot(x,ua00_001,label='Ana 24h',linewidth=1,color='green')
ax1.plot(x,ua00_002,label='Ana 12h',linewidth=1,color='orange')
ax1.plot(x,ua00_003,label='Ana 06h',linewidth=1,color='cyan')
ax1.plot(x,ua00_004,label='Ana 03h',linewidth=1,color='purple')
ax1.set_ylim(-30,30)
ax1.set_xlim(-4000,4000)
ax1.set_xticks(np.arange(-4000,4001,2000))
ax1.legend(loc='best',fontsize='small')
ax1.set_title('0 h')
#ax1.set_xlabel('x (km)')
ax1.set_ylabel('Wind speed (m/s)')
ax2=fig.add_subplot(232)
ax2.plot(x,ut24_001,label='Truth',linewidth=2,color='red')
ax2.plot(x,ub24_001,label='Back',linewidth=1,color='blue')
ax2.plot(x,ua24_001,label='Ana 24h',linewidth=1,color='green')
ax2.plot(x,ua24_002,label='Ana 12h',linewidth=1,color='orange')
ax2.plot(x,ua24_003,label='Ana 06h',linewidth=1,color='cyan')
ax2.plot(x,ua24_004,label='Ana 03h',linewidth=1,color='purple')
ax2.set_ylim(-20,20)
ax2.set_xlim(-4000,4000)
ax2.set_xticks(np.arange(-4000,4001,2000))
ax2.legend(loc='best',fontsize='small')
ax2.set_title('24 h')
#ax2.set_xlabel('x (km)')
#ax2.set_ylabel('Wind speed (m/s)')
ax3=fig.add_subplot(233)
ax3.plot(x,ut48_001,label='Truth',linewidth=2,color='red')
ax3.plot(x,ub48_001,label='Back',linewidth=1,color='blue')
ax3.plot(x,ua48_001,label='Ana 24h',linewidth=1,color='green')
ax3.plot(x,ua48_002,label='Ana 12h',linewidth=1,color='orange')
ax3.plot(x,ua48_003,label='Ana 06h',linewidth=1,color='cyan')
ax3.plot(x,ua48_004,label='Ana 03h',linewidth=1,color='purple')
ax3.set_ylim(-15,15)
ax3.set_xlim(-4000,4000)
ax3.set_xticks(np.arange(-4000,4001,2000))
ax3.legend(loc='best',fontsize='small')
ax3.set_title('48 h')
#ax3.set_xlabel('x (km)')
ax4=fig.add_subplot(234)
er1=np.abs(ub00_001-ut00_001)-np.abs(ua00_001-ut00_001)
er2=np.abs(ub00_002-ut00_001)-np.abs(ua00_002-ut00_001)
er3=np.abs(ub00_003-ut00_001)-np.abs(ua00_003-ut00_001)
er4=np.abs(ub00_004-ut00_001)-np.abs(ua00_004-ut00_001)
#ax4.plot(x,ub00_001-ut00_001,label='Back',linewidth=2,color='red')
#ax4.plot(x,ua00_001-ut00_001,label='Ana 24h',linewidth=1,color='green')
#ax4.plot(x,ua00_002-ut00_001,label='Ana 12h',linewidth=1,color='orange')
#ax4.plot(x,ua00_003-ut00_001,label='Ana 06h',linewidth=1,color='cyan')
#ax4.plot(x,ua00_004-ut00_001,label='Ana 03h',linewidth=1,color='purple')
ax4.plot(x,er1,label='Ana 24h',linewidth=1,color='green')
ax4.plot(x,er2,label='Ana 12h',linewidth=1,color='orange')
ax4.plot(x,er3,label='Ana 06h',linewidth=1,color='cyan')
ax4.plot(x,er4,label='Ana 03h',linewidth=1,color='purple')
#ax4.set_ylim(-30,30)
ax4.set_xlim(-4000,4000)
ax4.set_xticks(np.arange(-4000,4001,2000))
#ax4.legend(loc='best',fontsize='small')
#ax4.set_title('0 h')
ax4.set_xlabel('x (km)')
ax4.set_ylabel('Error (m/s)')
ax5=fig.add_subplot(235)
ax5.plot(x,ub24_001-ut24_001,label='Back',linewidth=2,color='red')
ax5.plot(x,ua24_001-ut24_001,label='Ana 24h',linewidth=1,color='green')
ax5.plot(x,ua24_002-ut24_001,label='Ana 12h',linewidth=1,color='orange')
ax5.plot(x,ua24_003-ut24_001,label='Ana 06h',linewidth=1,color='cyan')
ax5.plot(x,ua24_004-ut24_001,label='Ana 03h',linewidth=1,color='purple')
#ax5.set_ylim(-20,20)
ax5.set_xlim(-4000,4000)
ax5.set_xticks(np.arange(-4000,4001,2000))
ax5.legend(loc='best',fontsize='small')
#ax5.set_title('24 h')
ax5.set_xlabel('x (km)')
#ax2.set_ylabel('Wind speed (m/s)')
ax6=fig.add_subplot(236)
ax6.plot(x,ub48_001-ut48_001,label='Back',linewidth=2,color='red')
ax6.plot(x,ua48_001-ut48_001,label='Ana 24h',linewidth=1,color='green')
ax6.plot(x,ua48_002-ut48_002,label='Ana 12h',linewidth=1,color='orange')
ax6.plot(x,ua48_003-ut48_003,label='Ana 06h',linewidth=1,color='cyan')
ax6.plot(x,ua48_004-ut48_004,label='Ana 03h',linewidth=1,color='purple')
#ax6.set_ylim(-15,15)
ax6.set_xlim(-4000,4000)
ax6.set_xticks(np.arange(-4000,4001,2000))
ax6.legend(loc='best',fontsize='small')
#ax6.set_title('48 h')
ax6.set_xlabel('x (km)')
#ax3.set_ylabel('Wind speed (m/s)')
figure = plt.gcf()
figure.set_size_inches(12, 7)
plt.savefig('../plots/Figure4a.png',dpi=600)
rms_b=np.sqrt(np.var(ub00_001-ut00_001))
rms_a1=np.sqrt(np.var(ua00_001-ut00_001))
rms_a2=np.sqrt(np.var(ua00_002-ut00_001))
rms_a3=np.sqrt(np.var(ua00_003-ut00_001))
rms_a4=np.sqrt(np.var(ua00_004-ut00_001))
rms_a5=np.sqrt(np.var(ua48_004-ut48_001))
print ("std b error",rms_b,"std a error",rms_a1,rms_a2,rms_a3,rms_a4)
print ("analysis residual",rms_a5)
plt.show()


