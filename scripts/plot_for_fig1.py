import matplotlib.pyplot as plt
import numpy as np
x,u0,u24=np.loadtxt('../data/fort.40',unpack=True)
x,u0,u48=np.loadtxt('../data/fort.41',unpack=True)
x,up0,up24=np.loadtxt('../data/fort.50',unpack=True)
x,up0,up48=np.loadtxt('../data/fort.51',unpack=True)
x,utl0,utl24=np.loadtxt('../data/fort.60',unpack=True)
x,utl0,utl48=np.loadtxt('../data/fort.61',unpack=True)
fig=plt.figure()
ax1=fig.add_subplot(231)
ax1.plot(x,u0,label='Truth',linewidth=2,color='red')
ax1.plot(x,up0,label='Back',linewidth=2,color='blue',linestyle='--')
ax1.set_ylim(-30,30)
ax1.set_xlim(-4000,4000)
ax1.set_xticks(np.arange(-4000,4001,2000))
ax1.legend(loc='best',fontsize='small')
ax1.set_title('0 h')
#ax1.set_xlabel('x (km)')
ax1.set_ylabel('Wind speed (m/s)')
ax2=fig.add_subplot(232)
ax2.plot(x,u24,label='Truth',linewidth=2,color='red')
ax2.plot(x,up24,label='Back',linewidth=2,color='blue',linestyle='--')
ax2.set_ylim(-20,20)
ax2.set_xlim(-4000,4000)
ax2.set_xticks(np.arange(-4000,4001,2000))
ax2.legend(loc='best',fontsize='small')
ax2.set_title('24 h')
#ax2.set_xlabel('x (km)')
#ax2.set_ylabel('Wind speed (m/s)')
ax3=fig.add_subplot(233)
ax3.plot(x,u48,label='Truth',linewidth=2,color='red')
ax3.plot(x,up48,label='Back',linewidth=2,color='blue',linestyle='--')
ax3.set_ylim(-15,15)
ax3.set_xlim(-4000,4000)
ax3.set_xticks(np.arange(-4000,4001,2000))
ax3.legend(loc='best',fontsize='small')
ax3.set_title('48 h')
#ax3.set_xlabel('x (km)')
ax4=fig.add_subplot(234)
ax4.plot(x,up0-u0,label='nonlinear',linewidth=2,color='red')
ax4.plot(x,utl0,label='TL',linewidth=2,color='blue',linestyle='--')
#ax4.set_ylim(-30,30)
ax4.set_xlim(-4000,4000)
ax4.set_xticks(np.arange(-4000,4001,2000))
ax4.legend(loc='best',fontsize='small')
#ax4.set_title('0 h')
ax4.set_xlabel('x (km)')
ax4.set_ylabel('Error (m/s)')
ax5=fig.add_subplot(235)
ax5.plot(x,up24-u24,label='nonlinear',linewidth=2,color='red')
ax5.plot(x,utl24,label='TL',linewidth=2,color='blue',linestyle='--')
#ax5.set_ylim(-20,20)
ax5.set_xlim(-4000,4000)
ax5.set_xticks(np.arange(-4000,4001,2000))
ax5.legend(loc='best',fontsize='small')
#ax5.set_title('24 h')
ax5.set_xlabel('x (km)')
#ax2.set_ylabel('Wind speed (m/s)')
ax6=fig.add_subplot(236)
ax6.plot(x,up48-u48,label='nonlinear',linewidth=2,color='red')
ax6.plot(x,utl48,label='TL',linewidth=2,color='blue',linestyle='--')
#ax6.set_ylim(-15,15)
ax6.set_xlim(-4000,4000)
ax6.set_xticks(np.arange(-4000,4001,2000))
ax6.legend(loc='best',fontsize='small')
#ax6.set_title('48 h')
ax6.set_xlabel('x (km)')
#ax3.set_ylabel('Wind speed (m/s)')
figure = plt.gcf()
figure.set_size_inches(12, 7)
plt.savefig('../data/Figure1c.png',dpi=600)
plt.show()


