import matplotlib.pyplot as plt
import numpy as np
x,ub00_001,ut00_001,ua00_001=np.loadtxt('../data/output_00h_001.dat',unpack=True)
x,ub24_001,ut24_001,ua24_001=np.loadtxt('../data/output_24h_001.dat',unpack=True)
x,ub48_001,ut48_001,ua48_001=np.loadtxt('../data/output_48h_001.dat',unpack=True)
x,ub00_002,ut00_002,ua00_002=np.loadtxt('../data/output_00h_002.dat',unpack=True)
x,ub24_002,ut24_002,ua24_002=np.loadtxt('../data/output_24h_002.dat',unpack=True)
x,ub48_002,ut48_002,ua48_002=np.loadtxt('../data/output_48h_002.dat',unpack=True)
x,ub00_003,ut00_003,ua00_003=np.loadtxt('../data/output_00h_003.dat',unpack=True)
x,ub24_003,ut24_003,ua24_003=np.loadtxt('../data/output_24h_003.dat',unpack=True)
x,ub48_003,ut48_003,ua48_003=np.loadtxt('../data/output_48h_003.dat',unpack=True)
x,ub00_004,ut00_004,ua00_004=np.loadtxt('../data/output_00h_004.dat',unpack=True)
x,ub24_004,ut24_004,ua24_004=np.loadtxt('../data/output_24h_004.dat',unpack=True)
x,ub48_004,ut48_004,ua48_004=np.loadtxt('../data/output_48h_004.dat',unpack=True)
fig=plt.figure()
ax1=fig.add_subplot(211)
ax1.plot(x,ub24_001-ut24_001,label='Back',linewidth=2,color='red')
ax1.plot(x,ua24_001-ut24_001,label='Ana 24h',linewidth=1,color='green')
ax1.plot(x,ua24_002-ut24_001,label='Ana 12h',linewidth=1,color='orange')
ax1.plot(x,ua24_003-ut24_001,label='Ana 06h',linewidth=1,color='cyan')
ax1.plot(x,ua24_004-ut24_001,label='Ana 03h',linewidth=1,color='purple')
#ax1.set_ylim(-20,20)
ax1.set_xlim(-4000,4000)
ax1.set_xticks(np.arange(-4000,4001,2000))
ax1.legend(loc='best',fontsize='small')
ax1.set_title('24 h: end assimilation window')
#ax1.set_xlabel('x (km)')
ax1.set_ylabel('Error in wind speed (m/s)')
ax2=fig.add_subplot(212)
ax2.plot(x,ub48_001-ut48_001,label='Back',linewidth=2,color='red')
ax2.plot(x,ua48_001-ut48_001,label='Ana 24h',linewidth=1,color='green')
ax2.plot(x,ua48_002-ut48_002,label='Ana 12h',linewidth=1,color='orange')
ax2.plot(x,ua48_003-ut48_003,label='Ana 06h',linewidth=1,color='cyan')
ax2.plot(x,ua48_004-ut48_004,label='Ana 03h',linewidth=1,color='purple')
#ax2.set_ylim(-15,15)
ax2.set_xlim(-4000,4000)
ax2.set_xticks(np.arange(-4000,4001,2000))
ax2.legend(loc='best',fontsize='small')
ax2.set_title('48 h: 24-h forecast')
ax2.set_xlabel('x (km)')
ax2.set_ylabel('Error in wind speed (m/s)')
figure = plt.gcf()
figure.set_size_inches(7, 12)
plt.savefig('../plots/Figure5a.png',dpi=600)
rms_b=np.sqrt(np.var(ub00_001-ut00_001))
rms_a1=np.sqrt(np.var(ua00_001-ut00_001))
rms_a2=np.sqrt(np.var(ua00_002-ut00_001))
rms_a3=np.sqrt(np.var(ua00_003-ut00_001))
rms_a4=np.sqrt(np.var(ua00_004-ut00_001))
rms_a5=np.sqrt(np.var(ua48_004-ut48_001))
print ("std b error",rms_b,"std a error",rms_a1,rms_a2,rms_a3,rms_a4)
print ("analysis residual",rms_a5)
eqm_b=np.sqrt(np.mean((ub00_001-ut00_001)**2))
eqm_4=np.sqrt(np.mean((ua00_004-ut00_004)**2))
eqm_3=np.sqrt(np.mean((ua00_003-ut00_003)**2))
eqm_2=np.sqrt(np.mean((ua00_002-ut00_002)**2))
eqm_1=np.sqrt(np.mean((ua00_001-ut00_001)**2))
print ("eqm b error",eqm_b,eqm_4,eqm_3,eqm_2,eqm_1)
plt.show()


