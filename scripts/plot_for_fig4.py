import matplotlib.pyplot as plt
import numpy as np
x,ub00_001,ut00_001,ua00_001=np.loadtxt('../data/output_00h_001.dat',unpack=True)
x,ub24_001,ut24_001,ua24_001=np.loadtxt('../data/output_24h_001.dat',unpack=True)
x,ub48_001,ut48_001,ua48_001=np.loadtxt('../data/output_48h_001.dat',unpack=True)
x,ub00_002,ut00_002,ua00_002=np.loadtxt('../data/output_00h_002.dat',unpack=True)
x,ub24_002,ut24_002,ua24_002=np.loadtxt('../data/output_24h_002.dat',unpack=True)
x,ub48_002,ut48_002,ua48_002=np.loadtxt('../data/output_48h_002.dat',unpack=True)
x,ub00_003,ut00_003,ua00_003=np.loadtxt('../data/output_00h_003.dat',unpack=True)
x,ub24_003,ut24_003,ua24_003=np.loadtxt('../data/output_24h_003.dat',unpack=True)
x,ub48_003,ut48_003,ua48_003=np.loadtxt('../data/output_48h_003.dat',unpack=True)
x,ub00_004,ut00_004,ua00_004=np.loadtxt('../data/output_00h_004.dat',unpack=True)
x,ub24_004,ut24_004,ua24_004=np.loadtxt('../data/output_24h_004.dat',unpack=True)
x,ub48_004,ut48_004,ua48_004=np.loadtxt('../data/output_48h_004.dat',unpack=True)
fig=plt.figure()
ax1=fig.add_subplot(111)
ax1.plot(x,ut00_001,label='Truth',linewidth=3,color='red')
ax1.plot(x,ub00_001,label='Back',linewidth=2,color='blue')
ax1.plot(x,ua00_001,label='Ana 24h',linewidth=1,color='green')
ax1.plot(x,ua00_002,label='Ana 12h',linewidth=1,color='orange')
ax1.plot(x,ua00_003,label='Ana 06h',linewidth=1,color='cyan')
ax1.plot(x,ua00_004,label='Ana 03h',linewidth=1,color='purple')
ax1.set_ylim(-30,30)
ax1.set_xlim(-4000,4000)
ax1.set_xticks(np.arange(-4000,4001,2000))
ax1.legend(loc='best',fontsize='medium')
ax1.set_title('Initial conditions')
ax1.set_xlabel('x (km)')
ax1.set_ylabel('Wind speed (m/s)')
figure = plt.gcf()
figure.set_size_inches(7, 5)
plt.savefig('../plots/Figure4.png',dpi=600)
rms_b=np.sqrt(np.var(ub00_001-ut00_001))
rms_a1=np.sqrt(np.var(ua00_001-ut00_001))
rms_a2=np.sqrt(np.var(ua00_002-ut00_001))
rms_a3=np.sqrt(np.var(ua00_003-ut00_001))
rms_a4=np.sqrt(np.var(ua00_004-ut00_001))
rms_a5=np.sqrt(np.var(ua48_004-ut48_001))
print ("std b error",rms_b,"std a error",rms_a1,rms_a2,rms_a3,rms_a4)
print ("analysis residual",rms_a5)
plt.show()


